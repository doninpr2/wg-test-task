## wargaming-test-task

# Задание
### Формулировка:
- Разработать программу, которая открывает окно с пустой сценой на PyQT и по двойному нажатию на сцену добавляет прямоугольники разного цвета в то место, где было произведено двойное нажатие. 
- Прямоугольники можно перетаскивать по сцене. 
- Между прямоугольниками можно создавать/удалять связь (визуально - линия).

### Реализация:
- Размер прямоугольников константен (отношение сторон 2:1).
- Цвет создаваемого прямоугольника выбирается случайным образом в момент его создания.
- Выбор способа создания/удаления связи между прямоугольниками осуществляется разработчиком.
- Прямоугольники не могут перекрывать друг друга при создании и перетаскивании.
- Прямоугольники не могут выходить за границы окна/сцены при создании и перетаскивании.
- При взаимодействии с прямоугольником учитываются все возможные коллизии.
- Для упрощения, прямоугольник не создается, если область на сцене, по которой произведен двойной клик, слишком мала для размещения в ней прямоугольника.
- При перетаскивании прямоугольника связанные с ним фигуры остаются на месте, созданные связи сохраняются и обновляются.
- Прямоугольник создаётся с центром в точке клика, перетаскивается за любое место.
- Обойтись только библиотекой PyQT со стадартными инструментами для рисования и виджетов (Widget, Brush, Rectangle и т. п.)
- * Будет плюсом, если при перетаскивании на занятое место прямоугольник будет вставать вплотную к препятствию (упираться в коллизию  на последнем доступном месте), а не возвращаться на прежнюю позицию мыши.

### Что не успел сделать:
- Проверка на коллизии работает не самым лучшим образом, при быстро перемещении прямоугольник может ""проскочить"" через другой прямоугольник либо встать не вплотную к препятствию. Данная проблема может быть решена реализацией метода move_and_collide, который будет перемещать прямоугольник на 1 пиксель в направлении движения до тех пор, пока не упрется в препятствие.
- Исправить некоторые ошибки Qt в консоли
- нет проверки на создание дубликатов связей

# Взаимодействие с приложением
- Двойной клик на сцене - создание прямоугольника
- Перетаскивание прямоугольника - перемещение прямоугольника
- Клик на прямоугольник - выделение прямоугольника для создания связи
- Клик на другой прямоугольник - создание связи между прямоугольниками
- Клик на связь - удаление связи
 

# Реализация
### Структура проекта:
- `domain` - Слой доменной области
- `domain/entities` - Бизнес сущности
- `domain/usecases` - Бизнес логика
- `domain/utils` - Вспомогательные классы и инструменты

- `frameworks` - Внешний слой (Библиотеки, фреймворки, базы данных и т.д.)
- `frameworks/storages` - Реализация хранилищ данных
- `frameworks/views` - Реализация представлений (UI)

- `main.py` - Главный файл
- `constants.py` - Константы
- `container.py` - Реализация Dependency Injection (DI) контейнера
- `run_tests.py` - Запуск тестов

### Запуск приложения:
1. Создать виртуальное окружение `python -m venv venv`
2. Активировать виртуальное окружение `source venv/bin/activate`
3. Установить зависимости `pip install -r requirements.txt`
4. Запустить приложение `python src/main.py`

Запуск тестов: `python src/run_tests.py`

Для удобства был создан файл Makefile, который содержит команды для запуска приложения и тестов.

Версия Python: 3.9.9

### Описание архитектуры:
За основу архитектуры был взят Clean Architecture, однако в целях упрощения был убран промещуточный слой адаптеров между слоями домена и фреймворков.

Подробнее о Clean Architecture:
- https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html

Подробнее о Dependency Injection:
- https://en.wikipedia.org/wiki/Dependency_injection

Подробнее о SOLID:
- https://en.wikipedia.org/wiki/SOLID
